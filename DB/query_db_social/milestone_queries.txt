USE db_social;

# Seleziona gli utenti che hanno postato almeno un video
SELECT u.username, p.title, m.created_at 
FROM medias m
JOIN users u ON u.id = m.user_id
JOIN posts p ON p.user_id = u.id
WHERE m.type LIKE 'video';

# Seleziona tutti i post senza Like (13)
SELECT p.id, p.user_id, p.date
FROM posts p 
LEFT JOIN likes l ON l.post_id = p.id
WHERE l.post_id IS NULL;

# Conta il numero di like per ogni post (152)
SELECT COUNT(*) as 'total likes', p.title
FROM posts p 
JOIN likes l ON l.post_id = p.id
GROUP BY l.post_id;

# Ordina gli utenti per il numero di media caricati (25)
SELECT u.username, COUNT(*) as 'total medias' 
FROM users u 
JOIN medias m ON m.user_id = u.id 
GROUP BY u.id
ORDER BY COUNT(u.id) DESC;

# Ordina gli utenti per totale di likes ricevuti nei loro posts (25)
SELECT u.username, COUNT(*) as 'total likes'
FROM users u 
JOIN posts p ON p.user_id = u.id 
JOIN likes l ON l.post_id = p.id
GROUP BY u.id
ORDER BY COUNT(p.id) DESC;
